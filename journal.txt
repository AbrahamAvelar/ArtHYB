mummer4/4.0 
nucmer --prefix=SC_SP  /mnt/Timina/lmorales/Public/ymez/data/ref/SACE_S288C_v1/fasta/SACE_S288C_v1_allChr.fasta   /mnt/Timina/lmorales/Public/ymez/data/ref/SAPA_YPS138_v1/fasta/SAPA_YPS138_v1_allChr.fasta 
delta-filter -r -q SC_SP.delta > filtered_SCSP.delta
show-coords -rcl filtered_SCSP.delta > alignments.coords

nucmer --prefix=sac_par_synteny -c 40 -l 15 -b 500 S_cerevisiae.fasta S_paradoxus.fasta # esta no la corrÃ­
# -c cluster length (default 65) # -l match length (default 20)   # -b break length to allow size of the gaps (default 200)

delta-filter -i 70 -l 500 filtered_SCSP.delta > filtered_SCSP_2.delta # i minimum identity. -l minimum length of alignments
show-coords -rcl filtered_SCSP_2.delta > sac_par_synteny.coords

/mnt/Timina/lmorales/Public/ymez/data/ref/Mummer_SCSP/

cp /mnt/Timina/lmorales/Public/ymez/tmp/05_vcalling/*.tbi   x|
 sed 's/ /,/g' sac_par_synteny.coords| sed 's/|//g' |sed 's/,,,,/,/g'|sed 's/,,,/,/g'|sed 's/,,/,/g'|sed 's/\t/,/g' | head > sc_sp_coords.txt


bash coords2chain.sh sac_par_synteny.coords output.chain  

module load liftover/liftover
cp /mnt/Timina/lmorales/Public/ymez/tmp/05_vcalling/YMX004655_CONC.SNP_onlychr_SAPA.g.vcf
/mnt/Timina/lmorales/Public/ymez/tmp/05_vcalling/YMX004655_CONC.SNP_onlychr_SACE.g.vcf

tabix -p vcf S_paradoxus.vcf.gz


###################

cd /mnt/Timina/lmorales/Public/ymez/data/ref/Mummer_SCSP
module load samtools/1.9
bash extractCoverFromBed.sh YMX004655_CONC.rmdup.addgp.bam  sp_cords.tsv output__sp.depth
bash extractCoverFromBed.sh YMX004655_CONC.rmdup.addgp.bam  sc_cords.tsv output__sc.depth

module load samtools/1.9
bash run_extract_samples.sh /mnt/Timina/lmorales/Public/ymez/data/metadata/hybrids79.csv

/mnt/Timina/lmorales/Public/ymez/data/ref/Mummer_SCSP/sp_cords.tsv
ls -alth /mnt/Timina/lmorales/Public/ymez/data/bam/ | head 






##################
# 0 download
# 00_Download
vim /mnt/Timina/lmorales/Public/ymez/data/metadata/missingHybrids.csv
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/00_download
python3.7 download_sra.py -s /mnt/Timina/lmorales/Public/ymez/data/metadata/missingHybrids.csv
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/00_download
mv javelar_SH_download_SRA.sh javelar_SH_download_SRA_MissingHybrids.sh
bash javelar_SH_download_SRA_MissingHybrids.sh



# 02_Cleaning
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/02_cleaning
module load python37/3.7.0
python3.7 clean_fastq.py -s  /mnt/Timina/lmorales/Public/ymez/tmp/06_genotyping/trees/SACE192_NewXA/NewSACE_XA/SACE8_Faltantes_toDownload_XA.csv
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/02_cleaning
bash  javelar_SH_clean_fastq.sh

# 03_Mapping 
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/03_mapping
module load python37/3.7.0
python3.7 mapping2ref.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/Public/ymez/tmp/06_genotyping/trees/SACE192_NewXA/NewSACE_XA/SACE8_Faltantes_toDownload_XA.csv
exit
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/03_mapping
mv javelar_SH_map2ref.sh javelar_SH_map2ref_MissXA.sh
bash javelar_SH_map2ref_MissXA.sh


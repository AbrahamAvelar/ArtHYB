# 05_vcalling

qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/05_vcalling
module load python37/3.7.0
python3.7 vcalling_genotyping_isolates_GATK.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/javelar/samplesheets/SACE508.csv
exit 
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/05_vcalling
mv  javelar_SH_vcalling_genotyping.sh  javelar_SH_vcalling_genotyping_SACE508.sh
bash javelar_SH_vcalling_genotyping_SACE508.sh # solo lo mandé y me di cuenta que este no era. borré todos los jobs. ojala que no se hayan arruinado los archivos de los 1095491 1095500 primeros 10


module load python37/3.7.0
python3.7 genotyping_and_filtering.py   -s /mnt/Timina/lmorales/javelar/samplesheets/SACE508.csv  -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -m .1

Warning: from SACE missing 8 vcf files for SACE. A list of missing files can be found at /mnt/Timina/lmorales/Public/ymez/tmp/05_vcalling/missingVcfs_SACE_from_SACE_923381374cd84a84bb8117d9ea3ed248.log

SRR800768
SRR800854
ERR1309075
SRR800807
ERR1308632
SRR5678553
SRR5688258
SRR6514499


# 03_Mapping 
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/03_mapping
module load python37/3.7.0
python3.7 mapping2ref.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/javelar/samplesheets/SACE8_MissingToSACE.csv
exit
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/03_mapping
mv javelar_SH_map2ref.sh javelar_SH_map2ref_MissAlp.sh
bash javelar_SH_map2ref_MissAlp.sh


#04_coverage # 
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/04_coverage
module load python37/3.7.0
python3.7 coverage_plot.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s  /mnt/Timina/lmorales/javelar/samplesheets/SACE8_MissingToSACE.csv
exit
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/04_coverage
bash javelar_SH_coverage_plot.sh


# 00_Download #### LAS DE ECUADOR!
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/00_download
module load python37/3.7.0
python3.7 download_sra.py -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SACE5_Ecuador.csv
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/00_download
bash javelar_SH_download_SRA.sh

# 02_Cleaning
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/02_cleaning
module load python37/3.7.0
python3.7 clean_fastq.py -s  /mnt/Timina/lmorales/Public/ymez/data/metadata/SACE5_Ecuador.csv
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/02_cleaning
bash  javelar_SH_clean_fastq.sh

# 03_Mapping 
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/03_mapping
module load python37/3.7.0
python3.7 mapping2ref.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_CONC.txt -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SACE5_Ecuador.csv
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/03_mapping
bash /javelar_SH_map2ref_EcuadorCONC.sh

qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/03_mapping
module load python37/3.7.0
python3.7 mapping2ref.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SACE5_Ecuador.csv
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/03_mapping
bash javelar_SH_map2ref_MissAlp.sh

#04_coverage # 
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/04_coverage
module load python37/3.7.0
python3.7 coverage_plot.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s  /mnt/Timina/lmorales/Public/ymez/data/metadata/SACE5_Ecuador.csv
exit
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/04_coverage
bash javelar_SH_coverage_plot.sh

python3.7 coverage_plot.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_CONC.txt -s  /mnt/Timina/lmorales/Public/ymez/data/metadata/SACE5_Ecuador.csv



# 05_vcalling
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/05_vcalling
module load python37/3.7.0
python3.7 vcalling_genotyping_isolates_GATK.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SACE5_Ecuador.csv
bash javelar_SH_vcalling_genotyping.sh

# 05_vcalling OnlyChr 17:44-17:55
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/05_vcalling
module load python37/3.7.0
python3.7 SNPs_onlyChr.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SACE5_Ecuador.csv --subgenome SACE
exit
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/05_vcalling
bash javelar_SH_vcfOnlychr_SACE37_AddEcuadorAndNAOak.sh
